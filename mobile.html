<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能定投系统 - 移动端</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="css/mobile.css">
    <script src="js/config.js"></script>
    <script src="js/shared.js"></script>
</head>
<body>
<div class="container">
    <div class="index-dashboard">
        <div class="index-title">
            <span>📊 全球市场指数</span>
            <button class="index-refresh-btn" onclick="showUserIdManager()">🔑 用户ID</button>
            <button class="index-refresh-btn" onclick="location.reload()">🔄 刷新</button>
        </div>
        <div class="index-grid">
            <div class="index-item" id="index-ndx">
                <div class="index-name">纳斯达克100</div>
                <div class="index-value">--</div>
                <div class="index-change">--</div>
            </div>
            <div class="index-item" id="index-spx">
                <div class="index-name">标普500</div>
                <div class="index-value">--</div>
                <div class="index-change">--</div>
            </div>
            <div class="index-item" id="index-csi300">
                <div class="index-name">沪深300</div>
                <div class="index-value">--</div>
                <div class="index-change">--</div>
            </div>
            <div class="index-item" id="index-redlow">
                <div class="index-name">中证红利低波</div>
                <div class="index-value">--</div>
                <div class="index-change">--</div>
            </div>
            <div class="index-item" id="index-gold">
                <div class="index-name">黄金</div>
                <div class="index-value">--</div>
                <div class="index-change">--</div>
            </div>
        </div>
    </div>
    
    <div class="daily-pnl-dashboard" id="dailyPnlPanel">
        <div class="pnl-card">
            <div class="pnl-header">
                <div class="pnl-title">💰 持仓看板</div>
            </div>

            <div class="pnl-summary">
                <div class="pnl-summary-item">
                    <span class="pnl-label">持仓市值</span>
                    <span class="pnl-value-large" id="totalAssetInPnl">0</span>
                </div>
                <div class="pnl-summary-item">
                    <span class="pnl-label">累计收益</span>
                    <span class="pnl-value-large" id="totalProfitInPnl">0</span>
                    <span class="pnl-rate" id="totalProfitRateInPnl">0%</span>
                </div>
                <div class="pnl-summary-item">
                    <span class="pnl-label">今日收益</span>
                    <span class="pnl-value" id="totalDailyPnl">0</span>
                    <span class="pnl-rate" id="dailyProfitRate">0%</span>
                </div>
                <div class="pnl-summary-item">
                    <span class="pnl-label">持仓基金数</span>
                    <span class="pnl-count-total" id="totalFundCount">0</span>
                    <span class="pnl-rate" id="profitLossRatio">0/0</span>
                </div>
            </div>
            <div class="pnl-loading" id="pnlLoading">
                <div class="loading-spinner"></div>
                <div>正在获取今日净值数据...</div>
            </div>
        </div>
        <div class="pnl-content" id="pnlContent"></div>
    </div>
    
    <div id="userIdModal" class="modal-overlay" onclick="if(event.target === this) closeUserIdManager()">
        <div class="modal-content">
            <div class="modal-title">🔑 用户ID管理</div>
            <div class="modal-section">
                <div class="modal-label">当前用户ID</div>
                <div class="modal-value" id="currentUserId"></div>
            </div>
            <div class="modal-section">
                <button class="modal-btn" onclick="copyUserId()">📋 复制用户ID</button>
            </div>
            <div class="modal-section">
                <div class="modal-label">设置新的用户ID</div>
                <input type="text" id="newUserIdInput" class="modal-input" placeholder="输入新的用户ID">
                <button class="modal-btn" onclick="applyNewUserId()">✅ 应用新ID</button>
            </div>
            <div class="modal-section">
                <button class="modal-btn modal-btn-danger" onclick="confirmResetUserId()">🔄 重置用户ID</button>
            </div>
            <div class="modal-section">
                <button class="modal-btn modal-btn-secondary" onclick="closeUserIdManager()">关闭</button>
            </div>
        </div>
    </div>
</div>

<script src="js/mobile.js"></script>
</body>
</html>
