# 🎉 云端版使用说明

## ✅ 已完成配置

你的智能定投系统已经成功集成了 Supabase 云端存储功能！

### 配置信息：
- **Project URL**: https://tweusnlqlgiiuchlfbdr.supabase.co
- **用户ID**: 自动生成并保存在浏览器
- **数据表**: fund_data

---

## 🚀 如何使用

### 1. 打开HTML文件

直接双击打开 `我的智能定投补仓系统6.5.html` 文件

### 2. 首次使用

- 页面会自动尝试从云端加载数据
- 如果云端没有数据，会使用本地数据或默认数据
- 右上角会显示通知提示

### 3. 数据自动保存

**每次修改数据后，系统会自动：**
- ✅ 保存到浏览器本地（localStorage）
- ✅ 保存到云端（Supabase）
- ✅ 显示保存成功通知

**触发自动保存的操作：**
- 修改基金份额、成本、净值
- 添加/删除基金
- 添加/删除板块
- 修改板块权重
- 修改总投入金额

### 4. 手动云端操作

**保存到云端：**
- 点击 "☁️ 保存到云端" 按钮
- 手动触发云端保存

**从云端加载：**
- 点击 "📥 从云端加载" 按钮
- 重新从云端获取最新数据

---

## 🔄 多设备使用

### 方案A：使用相同的用户ID（当前方式）

**步骤：**
1. 在第一台设备上打开浏览器控制台（F12）
2. 输入：`console.log(userId)` 或 `localStorage.getItem('userId')`
3. 复制显示的用户ID（如：`user_1738369129_abc123`）
4. 在第二台设备上打开浏览器控制台
5. 输入：`localStorage.setItem('userId', 'user_1738369129_abc123')`（替换为你的ID）
6. 刷新页面

现在两台设备会使用同一份云端数据！

### 方案B：导入导出（简单方式）

1. 在设备A上点击 "⬇️ 备份配置" 导出JSON文件
2. 将JSON文件发送到设备B
3. 在设备B上点击 "⬆️ 恢复配置" 导入
4. 数据会自动同步到云端

---

## 📊 数据查看

### 在 Supabase 控制台查看数据：

1. 访问：https://supabase.com/dashboard
2. 登录你的账号
3. 选择项目：`fund-portfolio`
4. 点击左侧 "Table Editor"
5. 选择 `fund_data` 表
6. 可以看到你的所有数据

**数据结构：**
| 列名 | 说明 |
|------|------|
| id | 数据ID（自动生成）|
| user_id | 你的用户ID |
| data | 完整的基金数据（JSON格式）|
| created_at | 创建时间 |
| updated_at | 最后更新时间 |

---

## 🔍 调试和查看日志

### 打开浏览器控制台（F12）

**查看用户ID：**
```javascript
console.log('用户ID:', userId);
```

**查看当前数据：**
```javascript
console.log('当前数据:', appData);
```

**手动保存到云端：**
```javascript
saveToCloud();
```

**手动从云端加载：**
```javascript
loadFromCloud().then(data => console.log('云端数据:', data));
```

---

## ⚠️ 注意事项

### 1. 数据安全
- 你的数据存储在 Supabase 云端
- 建议定期使用 "备份配置" 导出JSON文件
- 妥善保管你的用户ID

### 2. 网络要求
- 需要联网才能同步到云端
- 如果网络断开，数据仍会保存在本地
- 网络恢复后，下次修改会自动同步

### 3. 浏览器兼容性
- 推荐使用 Chrome、Edge、Firefox 最新版
- 需要支持 ES6、async/await
- 需要允许跨域请求（Supabase已配置CORS）

### 4. 免费额度
- Supabase 免费版完全够用
- 每天 30,000 次 API 请求
- 500MB 数据库存储
- 你的使用量远低于限制

---

## 🐛 常见问题

### Q1: 提示"保存失败"怎么办？

**可能原因：**
1. 网络连接问题
2. Supabase 服务暂时不可用
3. 数据表配置错误

**解决方法：**
1. 检查网络连接
2. 打开浏览器控制台查看错误信息
3. 确认 Supabase 项目状态
4. 数据仍保存在本地，不会丢失

### Q2: 数据没有自动同步？

**检查步骤：**
1. 打开控制台，查看是否有错误
2. 确认用户ID是否一致
3. 手动点击 "从云端加载" 按钮
4. 检查 Supabase 表中是否有数据

### Q3: 如何重置数据？

**方法1：清空云端数据**
1. 访问 Supabase 控制台
2. 进入 Table Editor → fund_data
3. 删除你的数据行

**方法2：更换用户ID**
```javascript
// 在控制台执行
localStorage.removeItem('userId');
location.reload();
```

### Q4: 可以多人共享数据吗？

可以！只需要多人使用相同的用户ID：
1. 一个人分享自己的 userId
2. 其他人在控制台设置相同的 userId
3. 所有人都会看到同一份数据

---

## 🎯 工作流程图

```
打开页面
    ↓
尝试从云端加载
    ↓
有云端数据？
├─ 是 → 使用云端数据 → 渲染页面
└─ 否 → 使用本地数据 → 同步到云端 → 渲染页面
    ↓
用户修改数据
    ↓
自动保存到本地 + 云端
    ↓
显示保存成功通知
```

---

## 📱 部署到网上

### 使用 GitHub Pages（推荐）

1. 在 GitHub 创建仓库
2. 上传 HTML 文件
3. 启用 GitHub Pages
4. 访问：`https://你的用户名.github.io/仓库名/`

**详细步骤：**
1. 访问 https://github.com
2. 点击 "New repository"
3. 仓库名：`fund-portfolio`
4. 选择 "Public"
5. 创建后上传 HTML 文件
6. Settings → Pages → Source 选择 "main"
7. 等待1-2分钟即可访问

### 配置 Supabase 域名白名单

部署后需要添加域名到 Supabase：

1. 进入 Supabase 项目
2. Settings → API
3. 找到 "Site URL"
4. 添加你的部署域名（如：`https://你的用户名.github.io`）

---

## 🎉 完成！

现在你可以：
- ✅ 在任何设备上访问你的数据
- ✅ 数据自动保存到云端
- ✅ 不用担心浏览器缓存被清空
- ✅ 多设备数据同步
- ✅ 永久保存你的投资数据

享受你的智能定投系统吧！ 🚀
